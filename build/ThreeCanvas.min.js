!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.ThreeCanvas=e()}}(function(){return function e(t,r,n){function a(o,s){if(!r[o]){if(!t[o]){var c="function"==typeof require&&require;if(!s&&c)return c(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[o]={exports:{}};t[o][0].call(u.exports,function(e){var r=t[o][1][e];return a(r?r:e)},u,u.exports,e,t,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,r){t.exports={"default":e("core-js/library/fn/get-iterator"),__esModule:!0}},{"core-js/library/fn/get-iterator":11}],2:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/assign"),__esModule:!0}},{"core-js/library/fn/object/assign":12}],3:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/create"),__esModule:!0}},{"core-js/library/fn/object/create":13}],4:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/define-properties"),__esModule:!0}},{"core-js/library/fn/object/define-properties":14}],5:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":15}],6:[function(e,t,r){t.exports={"default":e("core-js/library/fn/object/keys"),__esModule:!0}},{"core-js/library/fn/object/keys":16}],7:[function(e,t,r){t.exports={"default":e("core-js/library/fn/set"),__esModule:!0}},{"core-js/library/fn/set":17}],8:[function(e,t,r){"use strict";r["default"]=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r.__esModule=!0},{}],9:[function(e,t,r){"use strict";var n=e("babel-runtime/core-js/object/define-property")["default"];r["default"]=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),n(e,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),r.__esModule=!0},{"babel-runtime/core-js/object/define-property":5}],10:[function(e,t,r){"use strict";r["default"]=function(e){return e&&e.__esModule?e:{"default":e}},r.__esModule=!0},{}],11:[function(e,t,r){e("../modules/web.dom.iterable"),e("../modules/es6.string.iterator"),t.exports=e("../modules/core.get-iterator")},{"../modules/core.get-iterator":63,"../modules/es6.string.iterator":69,"../modules/web.dom.iterable":71}],12:[function(e,t,r){e("../../modules/es6.object.assign"),t.exports=e("../../modules/$.core").Object.assign},{"../../modules/$.core":26,"../../modules/es6.object.assign":65}],13:[function(e,t,r){var n=e("../../modules/$");t.exports=function(e,t){return n.create(e,t)}},{"../../modules/$":44}],14:[function(e,t,r){var n=e("../../modules/$");t.exports=function(e,t){return n.setDescs(e,t)}},{"../../modules/$":44}],15:[function(e,t,r){var n=e("../../modules/$");t.exports=function(e,t,r){return n.setDesc(e,t,r)}},{"../../modules/$":44}],16:[function(e,t,r){e("../../modules/es6.object.keys"),t.exports=e("../../modules/$.core").Object.keys},{"../../modules/$.core":26,"../../modules/es6.object.keys":66}],17:[function(e,t,r){e("../modules/es6.object.to-string"),e("../modules/es6.string.iterator"),e("../modules/web.dom.iterable"),e("../modules/es6.set"),e("../modules/es7.set.to-json"),t.exports=e("../modules/$.core").Set},{"../modules/$.core":26,"../modules/es6.object.to-string":67,"../modules/es6.set":68,"../modules/es6.string.iterator":69,"../modules/es7.set.to-json":70,"../modules/web.dom.iterable":71}],18:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],19:[function(e,t,r){t.exports=function(){}},{}],20:[function(e,t,r){var n=e("./$.is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./$.is-object":38}],21:[function(e,t,r){var n=e("./$.cof"),a=e("./$.wks")("toStringTag"),i="Arguments"==n(function(){return arguments}());t.exports=function(e){var t,r,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=(t=Object(e))[a])?r:i?n(t):"Object"==(o=n(t))&&"function"==typeof t.callee?"Arguments":o}},{"./$.cof":22,"./$.wks":61}],22:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],23:[function(e,t,r){"use strict";var n=e("./$"),a=e("./$.hide"),i=e("./$.redefine-all"),o=e("./$.ctx"),s=e("./$.strict-new"),c=e("./$.defined"),l=e("./$.for-of"),u=e("./$.iter-define"),h=e("./$.iter-step"),d=e("./$.uid")("id"),f=e("./$.has"),p=e("./$.is-object"),m=e("./$.set-species"),v=e("./$.descriptors"),E=Object.isExtensible||p,b=v?"_s":"size",y=0,g=function(e,t){if(!p(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!f(e,d)){if(!E(e))return"F";if(!t)return"E";a(e,d,++y)}return"O"+e[d]},T=function(e,t){var r,n=g(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};t.exports={getConstructor:function(e,t,r,a){var u=e(function(e,i){s(e,u,t),e._i=n.create(null),e._f=void 0,e._l=void 0,e[b]=0,void 0!=i&&l(i,r,e[a],e)});return i(u.prototype,{clear:function(){for(var e=this,t=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete t[r.i];e._f=e._l=void 0,e[b]=0},"delete":function(e){var t=this,r=T(t,e);if(r){var n=r.n,a=r.p;delete t._i[r.i],r.r=!0,a&&(a.n=n),n&&(n.p=a),t._f==r&&(t._f=n),t._l==r&&(t._l=a),t[b]--}return!!r},forEach:function(e){for(var t,r=o(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(r(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!T(this,e)}}),v&&n.setDesc(u.prototype,"size",{get:function(){return c(this[b])}}),u},def:function(e,t,r){var n,a,i=T(e,t);return i?i.v=r:(e._l=i={i:a=g(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=i),n&&(n.n=i),e[b]++,"F"!==a&&(e._i[a]=i)),e},getEntry:T,setStrong:function(e,t,r){u(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?"keys"==t?h(0,r.k):"values"==t?h(0,r.v):h(0,[r.k,r.v]):(e._t=void 0,h(1))},r?"entries":"values",!r,!0),m(t)}}},{"./$":44,"./$.ctx":27,"./$.defined":28,"./$.descriptors":29,"./$.for-of":32,"./$.has":34,"./$.hide":35,"./$.is-object":38,"./$.iter-define":41,"./$.iter-step":42,"./$.redefine-all":49,"./$.set-species":51,"./$.strict-new":54,"./$.uid":60}],24:[function(e,t,r){var n=e("./$.for-of"),a=e("./$.classof");t.exports=function(e){return function(){if(a(this)!=e)throw TypeError(e+"#toJSON isn't generic");var t=[];return n(this,!1,t.push,t),t}}},{"./$.classof":21,"./$.for-of":32}],25:[function(e,t,r){"use strict";var n=e("./$"),a=e("./$.global"),i=e("./$.export"),o=e("./$.fails"),s=e("./$.hide"),c=e("./$.redefine-all"),l=e("./$.for-of"),u=e("./$.strict-new"),h=e("./$.is-object"),d=e("./$.set-to-string-tag"),f=e("./$.descriptors");t.exports=function(e,t,r,p,m,v){var E=a[e],b=E,y=m?"set":"add",g=b&&b.prototype,T={};return f&&"function"==typeof b&&(v||g.forEach&&!o(function(){(new b).entries().next()}))?(b=t(function(t,r){u(t,b,e),t._c=new E,void 0!=r&&l(r,m,t[y],t)}),n.each.call("add,clear,delete,forEach,get,has,set,keys,values,entries".split(","),function(e){var t="add"==e||"set"==e;e in g&&(!v||"clear"!=e)&&s(b.prototype,e,function(r,n){if(!t&&v&&!h(r))return"get"==e&&void 0;var a=this._c[e](0===r?0:r,n);return t?this:a})}),"size"in g&&n.setDesc(b.prototype,"size",{get:function(){return this._c.size}})):(b=p.getConstructor(t,e,m,y),c(b.prototype,r)),d(b,e),T[e]=b,i(i.G+i.W+i.F,T),v||p.setStrong(b,e,m),b}},{"./$":44,"./$.descriptors":29,"./$.export":30,"./$.fails":31,"./$.for-of":32,"./$.global":33,"./$.hide":35,"./$.is-object":38,"./$.redefine-all":49,"./$.set-to-string-tag":52,"./$.strict-new":54}],26:[function(e,t,r){var n=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},{}],27:[function(e,t,r){var n=e("./$.a-function");t.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,a){return e.call(t,r,n,a)}}return function(){return e.apply(t,arguments)}}},{"./$.a-function":18}],28:[function(e,t,r){t.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},{}],29:[function(e,t,r){t.exports=!e("./$.fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./$.fails":31}],30:[function(e,t,r){var n=e("./$.global"),a=e("./$.core"),i=e("./$.ctx"),o="prototype",s=function(e,t,r){var c,l,u,h=e&s.F,d=e&s.G,f=e&s.S,p=e&s.P,m=e&s.B,v=e&s.W,E=d?a:a[t]||(a[t]={}),b=d?n:f?n[t]:(n[t]||{})[o];d&&(r=t);for(c in r)l=!h&&b&&c in b,l&&c in E||(u=l?b[c]:r[c],E[c]=d&&"function"!=typeof b[c]?r[c]:m&&l?i(u,n):v&&b[c]==u?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[o]=e[o],t}(u):p&&"function"==typeof u?i(Function.call,u):u,p&&((E[o]||(E[o]={}))[c]=u))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,t.exports=s},{"./$.core":26,"./$.ctx":27,"./$.global":33}],31:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],32:[function(e,t,r){var n=e("./$.ctx"),a=e("./$.iter-call"),i=e("./$.is-array-iter"),o=e("./$.an-object"),s=e("./$.to-length"),c=e("./core.get-iterator-method");t.exports=function(e,t,r,l){var u,h,d,f=c(e),p=n(r,l,t?2:1),m=0;if("function"!=typeof f)throw TypeError(e+" is not iterable!");if(i(f))for(u=s(e.length);u>m;m++)t?p(o(h=e[m])[0],h[1]):p(e[m]);else for(d=f.call(e);!(h=d.next()).done;)a(d,p,h.value,t)}},{"./$.an-object":20,"./$.ctx":27,"./$.is-array-iter":37,"./$.iter-call":39,"./$.to-length":58,"./core.get-iterator-method":62}],33:[function(e,t,r){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],34:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],35:[function(e,t,r){var n=e("./$"),a=e("./$.property-desc");t.exports=e("./$.descriptors")?function(e,t,r){return n.setDesc(e,t,a(1,r))}:function(e,t,r){return e[t]=r,e}},{"./$":44,"./$.descriptors":29,"./$.property-desc":48}],36:[function(e,t,r){var n=e("./$.cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},{"./$.cof":22}],37:[function(e,t,r){var n=e("./$.iterators"),a=e("./$.wks")("iterator"),i=Array.prototype;t.exports=function(e){return void 0!==e&&(n.Array===e||i[a]===e)}},{"./$.iterators":43,"./$.wks":61}],38:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],39:[function(e,t,r){var n=e("./$.an-object");t.exports=function(e,t,r,a){try{return a?t(n(r)[0],r[1]):t(r)}catch(i){var o=e["return"];throw void 0!==o&&n(o.call(e)),i}}},{"./$.an-object":20}],40:[function(e,t,r){"use strict";var n=e("./$"),a=e("./$.property-desc"),i=e("./$.set-to-string-tag"),o={};e("./$.hide")(o,e("./$.wks")("iterator"),function(){return this}),t.exports=function(e,t,r){e.prototype=n.create(o,{next:a(1,r)}),i(e,t+" Iterator")}},{"./$":44,"./$.hide":35,"./$.property-desc":48,"./$.set-to-string-tag":52,"./$.wks":61}],41:[function(e,t,r){"use strict";var n=e("./$.library"),a=e("./$.export"),i=e("./$.redefine"),o=e("./$.hide"),s=e("./$.has"),c=e("./$.iterators"),l=e("./$.iter-create"),u=e("./$.set-to-string-tag"),h=e("./$").getProto,d=e("./$.wks")("iterator"),f=!([].keys&&"next"in[].keys()),p="@@iterator",m="keys",v="values",E=function(){return this};t.exports=function(e,t,r,b,y,g,T){l(r,t,b);var w,x,R=function(e){if(!f&&e in S)return S[e];switch(e){case m:return function(){return new r(this,e)};case v:return function(){return new r(this,e)}}return function(){return new r(this,e)}},M=t+" Iterator",H=y==v,j=!1,S=e.prototype,P=S[d]||S[p]||y&&S[y],$=P||R(y);if(P){var k=h($.call(new e));u(k,M,!0),!n&&s(S,p)&&o(k,d,E),H&&P.name!==v&&(j=!0,$=function(){return P.call(this)})}if(n&&!T||!f&&!j&&S[d]||o(S,d,$),c[t]=$,c[M]=E,y)if(w={values:H?$:R(v),keys:g?$:R(m),entries:H?R("entries"):$},T)for(x in w)x in S||i(S,x,w[x]);else a(a.P+a.F*(f||j),t,w);return w}},{"./$":44,"./$.export":30,"./$.has":34,"./$.hide":35,"./$.iter-create":40,"./$.iterators":43,"./$.library":45,"./$.redefine":50,"./$.set-to-string-tag":52,"./$.wks":61}],42:[function(e,t,r){t.exports=function(e,t){return{value:t,done:!!e}}},{}],43:[function(e,t,r){t.exports={}},{}],44:[function(e,t,r){var n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},{}],45:[function(e,t,r){t.exports=!0},{}],46:[function(e,t,r){var n=e("./$"),a=e("./$.to-object"),i=e("./$.iobject");t.exports=e("./$.fails")(function(){var e=Object.assign,t={},r={},n=Symbol(),a="abcdefghijklmnopqrst";return t[n]=7,a.split("").forEach(function(e){r[e]=e}),7!=e({},t)[n]||Object.keys(e({},r)).join("")!=a})?function(e,t){for(var r=a(e),o=arguments,s=o.length,c=1,l=n.getKeys,u=n.getSymbols,h=n.isEnum;s>c;)for(var d,f=i(o[c++]),p=u?l(f).concat(u(f)):l(f),m=p.length,v=0;m>v;)h.call(f,d=p[v++])&&(r[d]=f[d]);return r}:Object.assign},{"./$":44,"./$.fails":31,"./$.iobject":36,"./$.to-object":59}],47:[function(e,t,r){var n=e("./$.export"),a=e("./$.core"),i=e("./$.fails");t.exports=function(e,t){var r=(a.Object||{})[e]||Object[e],o={};o[e]=t(r),n(n.S+n.F*i(function(){r(1)}),"Object",o)}},{"./$.core":26,"./$.export":30,"./$.fails":31}],48:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],49:[function(e,t,r){var n=e("./$.redefine");t.exports=function(e,t){for(var r in t)n(e,r,t[r]);return e}},{"./$.redefine":50}],50:[function(e,t,r){t.exports=e("./$.hide")},{"./$.hide":35}],51:[function(e,t,r){"use strict";var n=e("./$.core"),a=e("./$"),i=e("./$.descriptors"),o=e("./$.wks")("species");t.exports=function(e){var t=n[e];i&&t&&!t[o]&&a.setDesc(t,o,{configurable:!0,get:function(){return this}})}},{"./$":44,"./$.core":26,"./$.descriptors":29,"./$.wks":61}],52:[function(e,t,r){var n=e("./$").setDesc,a=e("./$.has"),i=e("./$.wks")("toStringTag");t.exports=function(e,t,r){e&&!a(e=r?e:e.prototype,i)&&n(e,i,{configurable:!0,value:t})}},{"./$":44,"./$.has":34,"./$.wks":61}],53:[function(e,t,r){var n=e("./$.global"),a="__core-js_shared__",i=n[a]||(n[a]={});t.exports=function(e){return i[e]||(i[e]={})}},{"./$.global":33}],54:[function(e,t,r){t.exports=function(e,t,r){if(!(e instanceof t))throw TypeError(r+": use the 'new' operator!");return e}},{}],55:[function(e,t,r){var n=e("./$.to-integer"),a=e("./$.defined");t.exports=function(e){return function(t,r){var i,o,s=String(a(t)),c=n(r),l=s.length;return c<0||c>=l?e?"":void 0:(i=s.charCodeAt(c),i<55296||i>56319||c+1===l||(o=s.charCodeAt(c+1))<56320||o>57343?e?s.charAt(c):i:e?s.slice(c,c+2):(i-55296<<10)+(o-56320)+65536)}}},{"./$.defined":28,"./$.to-integer":56}],56:[function(e,t,r){var n=Math.ceil,a=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?a:n)(e)}},{}],57:[function(e,t,r){var n=e("./$.iobject"),a=e("./$.defined");t.exports=function(e){return n(a(e))}},{"./$.defined":28,"./$.iobject":36}],58:[function(e,t,r){var n=e("./$.to-integer"),a=Math.min;t.exports=function(e){return e>0?a(n(e),9007199254740991):0}},{"./$.to-integer":56}],59:[function(e,t,r){var n=e("./$.defined");t.exports=function(e){return Object(n(e))}},{"./$.defined":28}],60:[function(e,t,r){var n=0,a=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+a).toString(36))}},{}],61:[function(e,t,r){var n=e("./$.shared")("wks"),a=e("./$.uid"),i=e("./$.global").Symbol;t.exports=function(e){return n[e]||(n[e]=i&&i[e]||(i||a)("Symbol."+e))}},{"./$.global":33,"./$.shared":53,"./$.uid":60}],62:[function(e,t,r){var n=e("./$.classof"),a=e("./$.wks")("iterator"),i=e("./$.iterators");t.exports=e("./$.core").getIteratorMethod=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||i[n(e)]}},{"./$.classof":21,"./$.core":26,"./$.iterators":43,"./$.wks":61}],63:[function(e,t,r){var n=e("./$.an-object"),a=e("./core.get-iterator-method");t.exports=e("./$.core").getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},{"./$.an-object":20,"./$.core":26,"./core.get-iterator-method":62}],64:[function(e,t,r){"use strict";var n=e("./$.add-to-unscopables"),a=e("./$.iter-step"),i=e("./$.iterators"),o=e("./$.to-iobject");t.exports=e("./$.iter-define")(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,a(1)):"keys"==t?a(0,r):"values"==t?a(0,e[r]):a(0,[r,e[r]])},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},{"./$.add-to-unscopables":19,"./$.iter-define":41,"./$.iter-step":42,"./$.iterators":43,"./$.to-iobject":57}],65:[function(e,t,r){var n=e("./$.export");n(n.S+n.F,"Object",{assign:e("./$.object-assign")})},{"./$.export":30,"./$.object-assign":46}],66:[function(e,t,r){var n=e("./$.to-object");e("./$.object-sap")("keys",function(e){return function(t){return e(n(t))}})},{"./$.object-sap":47,"./$.to-object":59}],67:[function(e,t,r){},{}],68:[function(e,t,r){"use strict";var n=e("./$.collection-strong");e("./$.collection")("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return n.def(this,e=0===e?0:e,e)}},n)},{"./$.collection":25,"./$.collection-strong":23}],69:[function(e,t,r){"use strict";var n=e("./$.string-at")(!0);e("./$.iter-define")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})})},{"./$.iter-define":41,"./$.string-at":55}],70:[function(e,t,r){var n=e("./$.export");n(n.P,"Set",{toJSON:e("./$.collection-to-json")("Set")})},{"./$.collection-to-json":24,"./$.export":30}],71:[function(e,t,r){e("./es6.array.iterator");var n=e("./$.iterators");n.NodeList=n.HTMLCollection=n.Array},{"./$.iterators":43,"./es6.array.iterator":64}],72:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"],i=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var o=(e("./tools/OrbitControls"),e("./tools/TransformControls"),e("./ThreeCanvas")),s=i(o),c=function(){function e(t){a(this,e),this.loader=new THREE.ObjectLoader,this.scene=null,this.envScene=null,this.threeCanvas=t,this.prevTime=0,this.curObj=null,this.dirLight=null}return n(e,[{key:"currentObj",value:function(){if(null!=this.curObj)return this.curObj;var e=this;return this.scene.traverse(function(t){if(t instanceof THREE.Mesh)return e.curObj=t,e.curObj}),this.curObj}},{key:"curMaterial",value:function(){return null!=this.curMat?this.curMat:(this.curMat=this.createShaderMaterial(this.threeCanvas.getInputHeader()+s["default"].EMPTY_FRAG_SHADER,this.threeCanvas.getInputHeader()+s["default"].EMPTY_VERTEX_SHADER),this.curMat)}},{key:"curVertexShader",value:function(){return s["default"].removeShaderHeader(this.currentObj().material.vertexShader)}},{key:"curFragSahder",value:function(){return s["default"].removeShaderHeader(this.currentObj().material.fragmentShader)}},{key:"updateCurMaterial",value:function(e,t){this.curMaterial().vertexShader=t,this.curMaterial().fragmentShader=e,this.curMaterial().needsUpdate=!0}},{key:"createShaderMaterial",value:function(e,t){return new THREE.ShaderMaterial({uniforms:this.threeCanvas.getInputUniforms(),vertexShader:t,fragmentShader:e})}},{key:"clear",value:function(){if(null!=this.scene)for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0]);if(null!=this.envScene)for(;this.envScene.children.length>0;)this.envScene.remove(this.envScene.children[0]);this.curMat=null,this.curObj=null}},{key:"createSceneObject",value:function(e){var t=null,r=null,n=-1,a=14;if(0==e)r=new THREE.Vector3(0,n,0),t=new THREE.BoxGeometry(a,.1,a);else if(1==e){var i=THREE.Math.randFloat(.8,8);r=new THREE.Vector3(THREE.Math.randFloat(.5*-a,.5*a),i/2+n,THREE.Math.randFloat(.5*-a,.5*a));var o=THREE.Math.randFloat(.8,1.6);t=new THREE.BoxGeometry(o,i,o)}var s=new THREE.Color(16777215);s.setHex(16777215*THREE.Math.randFloat(.5,1)),0==e&&s.setHex(8947848);var c=new THREE.MeshPhongMaterial({color:s}),l=new THREE.Mesh(t,c);l.castShadow=!0,l.receiveShadow=!0,l.position.set(r.x,r.y,r.z),this.envScene.add(l)}},{key:"useLight",value:function(e){if(null!=this.envScene){var t=this.envScene.getObjectByName("dirLight");this.envScene.remove(t),e&&(this.dirLight=new THREE.DirectionalLight(16777215,1),this.dirLight.position.set(10,10,10),this.dirLight.target.position.set(0,0,0),this.dirLight.castShadow=!0,this.dirLight.name="dirLight",this.envScene.add(this.dirLight))}}},{key:"createEnvScene",value:function(){if(null!=this.envScene)for(;this.envScene.children.length>0;)this.envScene.remove(this.envScene.children[0]);this.envScene=new THREE.Scene,this.createSceneObject(0);for(var e=0;e<14;e++)this.createSceneObject(1);var t=new THREE.AmbientLight(4210752);this.envScene.add(t)}},{key:"clearEnvScene",value:function(){this.envScene=null,this.dirLight=null}},{key:"setObject",value:function(e){for(var t=this.scene.children.length-1;t>=0;t--){var r=this.scene.children[t];r instanceof THREE.Mesh&&this.scene.remove(r)}var n=null;0==e?n=new THREE.SphereGeometry(1,50,50):1==e?n=new THREE.BoxGeometry(1,1,1):2==e?n=new THREE.TorusKnotGeometry(1,.4,64,8):3==e?n=new THREE.PlaneGeometry(3,3,40,40):4==e?n=new THREE.CylinderGeometry(1,1,3,50):5==e?n=new THREE.IcosahedronGeometry(1,1):6==e&&(n=new THREE.TorusGeometry(1,.4,16,100)),this.curObj=new THREE.Mesh(n,this.curMaterial()),this.curObj.name="MeshObj",this.curObj.position.set(0,0,0);this.scene.add(this.curObj)}},{key:"newScene",value:function(){this.clear(),this.scene=new THREE.Scene}},{key:"load",value:function(e,t){this.clear(),this.scene=this.loader.parse(e.scene),null!=e.envScene&&(this.envScene=this.loader.parse(e.envScene),this.dirLight=this.envScene.getObjectByName("dirLight")),this.curMat=this.curMaterial(),this.updateCurMaterial(e.frag,e.vert),this.curMat.needsUpdate=!0,this.useLight(t.useLight)}},{key:"toJSON",value:function(){var e=this;return this.scene.traverse(function(t){if(t instanceof THREE.Mesh&&t.material instanceof THREE.ShaderMaterial){for(var r=0;r<e.threeCanvas.data.textures.length;r++){var n="iTexture"+r;t.material.uniforms[n].value=null}t.material.uniforms.iDepthTexture.value=null}}),{metadata:{},scene:this.scene.toJSON(),envScene:null!=this.envScene?this.envScene.toJSON():null,frag:this.curMaterial().fragmentShader,vert:this.curMaterial().vertexShader}}},{key:"updateUniforms",value:function(){var e=this,t=performance.now()/1e3;null!=e.dirLight&&(this.dirLight.position.set(10*Math.sin(t),10,10*Math.cos(t)),this.dirLight.target.position.set(0,0,0),e.dirLight.position.x<9999&&(e.currentObj().material.uniforms.iLightDirection.value=-this.dirLight.position)),e.currentObj().material.uniforms.iTime.value=t,e.currentObj().material.uniforms.iResolution.value.x=e.threeCanvas.canvas.clientWidth,e.currentObj().material.uniforms.iResolution.value.y=e.threeCanvas.canvas.clientHeight,e.currentObj().material.uniforms.iCameraNear.value=e.threeCanvas.camera.near,e.currentObj().material.uniforms.iCameraFar.value=e.threeCanvas.camera.far,e.currentObj().material.uniforms.iDepthTexture.value=e.threeCanvas.depthTarget.depthTexture;for(var r=0;r<e.threeCanvas.data.textures.length;r++){var n="iTexture"+r;e.currentObj().material.uniforms[n].value=e.threeCanvas.data.textures[r]}}}]),e}();r.Player=c},{"./ThreeCanvas":75,"./tools/OrbitControls":77,"./tools/TransformControls":78,"babel-runtime/helpers/class-call-check":8,"babel-runtime/helpers/create-class":9,"babel-runtime/helpers/interop-require-default":10}],73:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"],i=e("babel-runtime/helpers/interop-require-default")["default"];Object.defineProperty(r,"__esModule",{value:!0});var o=e("./ThreeCanvas"),s=(i(o),function(){function e(t,r,n,i,o,s,c,l){a(this,e),this.threeCanvas=t,this.width=t.canvas.clientWidth,this.height=t.canvas.clientHeight,this.index=c,null==l||void 0==l?this.passName="Name":this.passName=l,this.camera=new THREE.OrthographicCamera((-1),1,1,(-1),0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.material=new THREE.ShaderMaterial({uniforms:null,vertexShader:this.threeCanvas.getInputHeader()+s,fragmentShader:this.threeCanvas.getInputHeader()+o}),this.refreshUniforms(),this.renderer=r,this.renderToScreen=i,this.downRes=n,this.setTargetTexture(n),this.updateMaterial(this.threeCanvas.getInputHeader()+s,this.threeCanvas.getInputHeader()+o)}return n(e,[{key:"setSize",value:function(e,t){this.width=e,this.height=t,this.renderTarget.setSize(e*this.downRes,t*this.downRes)}},{key:"setRes",value:function(e){this.downRes=e,this.setSize(this.width,this.height)}},{key:"toJSON",value:function(){return{downRes:this.downRes,renderToScreen:this.renderToScreen,frag:this.material.fragmentShader,vertex:this.material.vertexShader,passName:this.passName}}},{key:"render",value:function(){this.quad.material=this.material,this.renderToScreen?this.renderer.render(this.scene,this.camera):this.renderer.render(this.scene,this.camera,this.renderTarget,!0)}},{key:"refreshUniforms",value:function(){this.uniforms=this.threeCanvas.getInputUniforms(),this.material.uniforms=this.uniforms}},{key:"updateMaterial",value:function(e,t){this.refreshUniforms(),this.material.vertexShader=e,this.material.fragmentShader=t,this.material.needsUpdate=!0}},{key:"setTargetTexture",value:function(e){var t={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},r=this.renderer.getDrawingBufferSize();this.renderTarget=new THREE.WebGLRenderTarget(r.width*e,r.height*e,t)}}]),e}());r.RenderPass=s},{"./ThreeCanvas":75,"babel-runtime/helpers/class-call-check":8,"babel-runtime/helpers/create-class":9,"babel-runtime/helpers/interop-require-default":10}],74:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(r,"__esModule",{value:!0});var i=(e("./RenderPass"),function(){function e(t){a(this,e),this.owner=t,this.textures=new Array(2),this.images={},this.editMode=0,this.blending=0,this.side=0,this.transparent=!1,this.objScale=new THREE.Vector3(1,1,1),this.objPos=new THREE.Vector3(0,0,0),this.objRot=new THREE.Vector3(0,0,0),this.objectType=0,this.flatShading=!1,this.wireframe=!1,this.depthWrite=!0,this.depthTest=!0,this.renderPasses=new Array,this.passDatas=[],this.showScene=!1,this.useLight=!1,this.animateScale=!1}return n(e,[{key:"toJSON",value:function(){var e=[];this.images={};var t=this.textures.slice();this.textures=new Array(2);for(var r=0;r<t.length;r++)null==t[r]||void 0==t[r].image||null==t[r].image?e.push(null):e.push(t[r].toJSON(this));this.textures=t,this.passDatas=[];for(var r=0;r<this.renderPasses.length;r++)this.passDatas.push(this.renderPasses[r].toJSON());return{textures:e,images:this.images,editMode:this.editMode,blending:this.blending,side:this.side,transparent:this.transparent,objScale:this.objScale,objPos:this.objPos,objRot:this.objRot,objectType:this.objectType,flatShading:this.flatShading,wireframe:this.wireframe,depthWrite:this.depthWrite,depthTest:this.depthTest,passDatas:this.passDatas,showScene:this.showScene,useLight:this.useLight,animateScale:this.animateScale}}},{key:"loadFromJSON",value:function(e){this.textures=e.textures,this.images=e.images,this.editMode=e.editMode,this.blending=void 0==e.blending?0:e.blending,this.side=void 0==e.side?0:e.side,this.transparent=void 0==e.transparent||e.transparent,this.objScale=e.objScale,this.objPos=e.objPos,this.objRot=e.objRot,this.objectType=void 0==e.objectType?0:e.objectType,this.flatShading=void 0!=e.flatShading&&e.flatShading,this.wireframe=void 0!=e.wireframe&&e.wireframe,this.depthWrite=void 0!=e.depthWrite&&e.depthWrite,this.depthTest=void 0!=e.depthTest&&e.depthTest,this.passDatas=e.passDatas,this.showScene=e.showScene,this.useLight=e.useLight,this.animateScale=void 0!=e.animateScale&&e.animateScale;for(var t=0;t<this.textures.length;t++)null==this.textures[t]&&(this.textures[t]={});var r=new THREE.ObjectLoader,n=[];for(var a in this.images)n.push(this.images[a]);for(var i=r.parseImages(n),o=r.parseTextures(this.textures,i),t=0;t<this.textures.length;t++)if(void 0!=this.textures[t].uuid)for(var a in o)this.textures[t].uuid===a&&(this.textures[t]=o[a])}}]),e}());r.TData=i},{"./RenderPass":73,"babel-runtime/helpers/class-call-check":8,"babel-runtime/helpers/create-class":9}],75:[function(e,t,r){"use strict";var n=e("babel-runtime/helpers/create-class")["default"],a=e("babel-runtime/helpers/class-call-check")["default"];Object.defineProperty(r,"__esModule",{value:!0});var i=e("./tools/mixin"),o=e("./tools/OrbitControls"),s=(e("./tools/Loader"),e("./tools/TransformControls"),e("./Player")),c=e("./RenderPass"),l=e("./TData"),u="\nprecision highp float;\n//Three.js Built-in uniforms and attributes\n//https://threejs.org/docs/#api/renderers/webgl/WebGLProgram\n// = object.matrixWorld\nuniform mat4 modelMatrix;\n// = camera.matrixWorldInverse * object.matrixWorld\nuniform mat4 modelViewMatrix;\n// = camera.projectionMatrix\nuniform mat4 projectionMatrix;\n// = camera.matrixWorldInverse\nuniform mat4 viewMatrix;\n// = inverse transpose of modelViewMatrix\nuniform mat3 normalMatrix;\n// = camera position in world space\nuniform vec3 cameraPosition;\n\n// default vertex attributes provided by Geometry and BufferGeometry\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n",h="\nprecision highp float;\n//Three.js Built-in uniforms and attributes\n//https://threejs.org/docs/#api/renderers/webgl/WebGLProgram\n// = object.matrixWorld\nuniform mat4 modelMatrix;\n// = camera.matrixWorldInverse * object.matrixWorld\nuniform mat4 modelViewMatrix;\n// = camera.projectionMatrix\nuniform mat4 projectionMatrix;\n// = camera.matrixWorldInverse\nuniform mat4 viewMatrix;\n// = inverse transpose of modelViewMatrix\nuniform mat3 normalMatrix;\n// = camera position in world space\nuniform vec3 cameraPosition;\n",d="\nvarying vec3 fNormal;\nvarying vec3 fPosition;\nvarying vec2 fUV;\n\nvoid main()\n{\n    fNormal = normal;\n    vec4 wpos = modelMatrix * vec4(position, 1.0);\n    fPosition = wpos.xyz;\n    fUV = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",f="\nvarying vec3 fPosition;\nvarying vec3 fNormal;\nvarying vec2 fUV;\n\nvec3 rim(vec3 color, float start, float end, float coef)\n{\n  vec3 normal = normalize(fNormal);\n  vec3 eye = normalize(cameraPosition- fPosition);\n  float rim = smoothstep(start, end, 1.0 - dot(normal, eye));\n  return clamp(rim, 0.0, 1.0) * coef * color;\n}\n\n\nvoid main()\n{\n    vec3 rimColor = rim(vec3(0.764,1.000,0.857),0.360,1.144,1.816);\n    vec3 baseColor = fNormal * sin(iTime * 3.0);\n    gl_FragColor = vec4(rimColor + baseColor,1.0);\n}\n",p="\nvarying vec2 fUV;\nvoid main() {\n    fUV = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",m="\nvarying vec2 fUV;\nvoid main() {\n    vec4 texel = texture2D( iSceneTexture, fUV );\n    gl_FragColor = texel;\n}\n",v="vec3 packNormalToRGB( const in vec3 normal ) {return normalize( normal ) * 0.5 + 0.5;\r\n}\r\n\r\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\r\n\treturn 2.0 * rgb.xyz - 1.0;\r\n}\r\n\r\nconst float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)\r\nconst float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)\r\n\r\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\r\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\r\n\r\nconst float ShiftRight8 = 1. / 256.;\r\n\r\nvec4 packDepthToRGBA( const in float v ) {\r\n\tvec4 r = vec4( fract( v * PackFactors ), v );\r\n\tr.yzw -= r.xyz * ShiftRight8; // tidy overflow\r\n\treturn r * PackUpscale;\r\n}\r\n\r\nfloat unpackRGBAToDepth( const in vec4 v ) {\r\n\treturn dot( v, UnpackFactors );\r\n}\r\n\r\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\r\n\r\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\r\n\treturn ( viewZ + near ) / ( near - far );\r\n}\r\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\r\n\treturn linearClipZ * ( near - far ) - near;\r\n}\r\n\r\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\r\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\r\n}\r\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\r\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\r\n}\r\n",E=function(){
function e(t){return a(this,e),(0,i.subscribeMixin)(this),this.player=void 0,this.inited=!1,this.frame=0,this.rendererInited=!1,this.completedCallback=void 0,this.transformControls=void 0,this.canvas=t,this.renderer=new THREE.WebGLRenderer({antialias:!0,canvas:this.canvas}),this.renderer.autoClear=!1,this.renderer.shadowMap.enabled=!0,this.renderer.setClearColor(0,0),this.renderer.setPixelRatio(window.devicePixelRatio),this.camera=new THREE.PerspectiveCamera(75,this.canvas.clientWidth/this.canvas.clientHeight,.1,1e3),this.camera.position.z=2,this.camera.position.y=2,this.camera.lookAt(0,0,0),this.limitFrame=-1,this.useControl=!0,this.sceneTarget=new THREE.WebGLRenderTarget(this.canvas.clientWidth,this.canvas.clientHeight),this.sceneTarget.texture.format=THREE.RGBAFormat,this.sceneTarget.texture.minFilter=THREE.NearestFilter,this.sceneTarget.texture.magFilter=THREE.NearestFilter,this.sceneTarget.texture.generateMipmaps=!1,this.sceneTarget.stencilBuffer=!1,this.sceneTarget.depthBuffer=!0,this.depthTarget=new THREE.WebGLRenderTarget(this.canvas.clientWidth,this.canvas.clientHeight),this.depthTarget.texture.format=THREE.RGBAFormat,this.depthTarget.texture.minFilter=THREE.NearestFilter,this.depthTarget.texture.magFilter=THREE.NearestFilter,this.depthTarget.texture.generateMipmaps=!1,this.depthTarget.stencilBuffer=!1,this.depthTarget.depthBuffer=!0,this.depthTarget.depthTexture=new THREE.DepthTexture,this.depthTarget.depthTexture.type=THREE.UnsignedShortType,this}return n(e,[{key:"getInputHeader",value:function(){for(var e="//header-begin\r\n",t="uniform float iTime;\r\nuniform vec2 iResolution;\r\nuniform sampler2D iDepthTexture;\r\nuniform sampler2D iSceneTexture;\r\nuniform float iCameraNear;\r\nuniform float iCameraFar;\r\n",r=0;r<this.data.textures.length;r++)t+="uniform sampler2D iTexture"+r+";\r\n";for(var r=0;r<this.data.renderPasses.length;r++)t+="uniform sampler2D iPass"+r+";\r\n";this.data.showScene&&this.data.useLight&&(t+="uniform vec3 iLightDirection;\r\n");var n="//header-end\r\n",a=e+t+n;return a}},{key:"getInputUniforms",value:function(){null!=this.input_uniforms&&void 0!=this.input_uniforms||(this.input_uniforms={iTime:{value:0},iResolution:{value:new THREE.Vector2},iSceneTexture:{value:null},iDepthTexture:{value:null},iCameraNear:{value:0},iCameraFar:{value:0},iLightDirection:{value:new THREE.Vector3(0,0,0)}});for(var e=0;e<this.data.textures.length;e++){var t="iTexture"+e;this.input_uniforms[t]={value:null}}for(var e=0;e<this.data.renderPasses.length;e++){var t="iPass"+e;this.input_uniforms[t]={value:null}}return this.input_uniforms}}],[{key:"removeShaderHeader",value:function(e){var t=e.indexOf("//header-begin"),r=e.indexOf("//header-end"),n=e.substr(t,r-t+13);return e=e.replace(n,""),e.startsWith("\n")&&(e=e.substr(1,e.length-1)),e.startsWith("\n")&&(e=e.substr(1,e.length-1)),e}},{key:"EMPTY_VERTEX_SHADER",get:function(){return d}},{key:"EMPTY_FRAG_SHADER",get:function(){return f}},{key:"VERTEX_HEADER_THREE",get:function(){return u}},{key:"FRAG_HEADER_THREE",get:function(){return h}},{key:"THREE_PACKING",get:function(){return v}}]),n(e,[{key:"resetCamera",value:function(){this.camera.position.z=2,this.camera.position.y=2,this.camera.lookAt(0,0,0),this.controls.target0=new THREE.Vector3,this.controls.position0=this.camera.position,this.controls.zoom0=this.camera.zoom,this.controls.reset()}},{key:"newPass",value:function(e){return new c.RenderPass(this,this.renderer,1,(!0),m,p,e)}},{key:"toJSON",value:function(){return{data:this.data.toJSON(),player:this.player.toJSON(),cameraPos:this.camera.position,cameraRot:this.camera.rotation.toVector3(),cameraController:this.controls.toJSON()}}},{key:"updateData",value:function(){this.player.setObject(this.data.objectType),this.player.curMaterial().blending=this.data.blending,this.player.curMaterial().side=this.data.side,this.player.curMaterial().flatShading=this.data.flatShading,this.player.curMaterial().transparent=this.data.transparent,this.player.curMaterial().wireframe=this.data.wireframe,this.player.curMaterial().depthWrite=this.data.depthWrite,this.player.curMaterial().depthTest=this.data.depthTest,this.player.currentObj().scale.set(this.data.objScale.x,this.data.objScale.y,this.data.objScale.z),this.player.currentObj().position.set(this.data.objPos.x,this.data.objPos.y,this.data.objPos.z),this.player.currentObj().rotation.set(this.data.objRot.x,this.data.objRot.y,this.data.objRot.z)}},{key:"load",value:function(e,t){var r=this;this.completedCallback=t;var n=new THREE.FileLoader;n.load(e,function(e){var t=JSON.parse(e);r.loadFromJSON(t.threeCanvas,r.completedCallback)})}},{key:"loadFromJSON",value:function(t,r){this.useControl&&(this.controls=new o.OrbitControls(this.camera,this.canvas),this.controls.enableKeys=!1),this.data=new l.TData(this),this.data.loadFromJSON(t.data),this.player=new s.Player(this),this.player.load(t.player,this.data),this.frame=0,this.rendererInited=!1,this.completedCallback=r;for(var n=0;n<this.data.passDatas.length;n++){var a=this.data.passDatas[n];this.data.renderPasses.push(new c.RenderPass(this,this.renderer,a.downRes,a.renderToScreen,e.removeShaderHeader(a.frag),e.removeShaderHeader(a.vertex),n,a.passName))}this.camera.position.set(t.cameraPos.x,t.cameraPos.y,t.cameraPos.z),this.camera.rotation.set(t.cameraRot.x,t.cameraRot.y,t.cameraRot.z),this.useControl&&(this.controls.fromJSON(t.cameraController),this.controls.reset()),this.updateData(),this.inited=!0,this.play()}},{key:"new",value:function(e){this.useControl&&(this.controls=new o.OrbitControls(this.camera,this.canvas),this.controls.enableKeys=!1),this.frame=0,this.rendererInited=!1,this.player=new s.Player(this),this.player.newScene(),this.completedCallback=e,this.data=new l.TData(this),this.updateData(),this.inited=!0,this.play()}},{key:"play",value:function(){function e(){if(t.rendererInited&&t.limitFrame>0&&t.frame%t.limitFrame!=0)return t.useControl&&t.controls.update(),window.requestAnimationFrame(e),void t.frame++;if(t.inited){t.player.updateUniforms(),null!=t.player.envScene?(t.renderer.render(t.player.envScene,t.camera,t.depthTarget,!0),t.renderer.render(t.player.scene,t.camera,t.depthTarget)):t.renderer.render(t.player.scene,t.camera,t.depthTarget,!0),t.updateUniforms(),0==t.data.renderPasses.length?null!=t.player.envScene?(t.renderer.render(t.player.envScene,t.camera,null,!0),t.renderer.render(t.player.scene,t.camera,null,!1)):t.renderer.render(t.player.scene,t.camera,null,!0):null!=t.player.envScene?(t.renderer.render(t.player.envScene,t.camera,t.sceneTarget,!0),t.renderer.render(t.player.scene,t.camera,t.sceneTarget)):t.renderer.render(t.player.scene,t.camera,t.sceneTarget,!0);for(var r=0;r<t.data.renderPasses.length;r++){if(t.data.renderPasses[r].material.uniforms.iSceneTexture.value=t.sceneTarget.texture,r>0){var n="iPass"+(r-1);t.data.renderPasses[r].material.uniforms[n].value=t.data.renderPasses[r-1].renderTarget.texture}t.data.renderPasses[r].render()}if(t.frame++,t.frame>1&&!t.rendererInited&&(null!=t.completedCallback&&void 0!=t.completedCallback&&t.completedCallback(),t.rendererInited=!0),t.data.animateScale){var a=performance.now()/1e3,i=.5*Math.sin(1*a)+.6;t.player.currentObj().scale.set(t.data.objScale.x*i,t.data.objScale.y*i,t.data.objScale.z*i)}}t.useControl&&t.controls.update(),window.requestAnimationFrame(e)}var t=this;this.prevTime=performance.now(),e()}},{key:"createGLShader",value:function(e,t,r){var n=this.getContext(),a=n.createShader(r);n.shaderSource(a,t),n.compileShader(a);var i=n.getShaderParameter(a,n.COMPILE_STATUS);if(!i){var o=n.getShaderInfoLog(a);console.error("*** Error compiling shader "+a+":"+o);return r==this.getContext().VERTEX_SHADER?e.trigger("vertex_error",{shader:a,source:t,type:r,error:o,headerLine:this.vertexHeaderLine()}):e.trigger("frag_error",{shader:a,source:t,type:r,error:o,headerLine:this.fragHeaderLine()}),n.deleteShader(a),null}return a}},{key:"getContext",value:function(){return this.renderer.getContext()}},{key:"resizeUseCanvas",value:function(){this.camera.aspect=this.canvas.clientWidth/this.canvas.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight);for(var e=this.renderer.getPixelRatio(),t=0;t<this.data.renderPasses.length;t++)this.data.renderPasses[t].setSize(this.canvas.clientWidth*e,this.canvas.clientHeight*e);this.sceneTarget.setSize(this.canvas.clientWidth*e,this.canvas.clientHeight*e)}},{key:"resize",value:function(e,t){this.canvas.style.width=e+"px",this.canvas.style.height=t+"px",this.resizeUseCanvas()}},{key:"curVertexShader",value:function(){return 0==this.data.editMode?this.player.curVertexShader():e.removeShaderHeader(this.data.renderPasses[this.data.editMode-1].material.vertexShader)}},{key:"curFragSahder",value:function(){return 0==this.data.editMode?this.player.curFragSahder():e.removeShaderHeader(this.data.renderPasses[this.data.editMode-1].material.fragmentShader)}},{key:"vertexHeaderLine",value:function(){return(this.getInputHeader()+e.VERTEX_HEADER_THREE).split(/\r\n|\r|\n/).length}},{key:"fragHeaderLine",value:function(){return(this.getInputHeader()+e.FRAG_HEADER_THREE).split(/\r\n|\r|\n/).length}},{key:"refreshUniforms",value:function(){this.player.curMaterial().uniforms=this.getInputUniforms();for(var e=0;e<this.data.renderPasses.length;e++)this.data.renderPasses[e].refreshUniforms()}},{key:"updateRenderPassUniforms",value:function(){for(var e=this,t=0;t<this.data.renderPasses.length;t++){this.data.renderPasses[t].material.uniforms.iTime.value=performance.now()/1e3,this.data.renderPasses[t].material.uniforms.iResolution.value.x=e.canvas.clientWidth,this.data.renderPasses[t].material.uniforms.iResolution.value.y=e.canvas.clientHeight,this.data.renderPasses[t].material.uniforms.iCameraNear.value=e.camera.near,this.data.renderPasses[t].material.uniforms.iCameraFar.value=e.camera.far,null!=e.player.dirLight&&e.player.dirLight.position.x<9999&&(this.data.renderPasses[t].material.uniforms.iLightDirection.value=-e.player.dirLight.position),this.data.renderPasses[t].material.uniforms.iDepthTexture.value=e.depthTarget.depthTexture;for(var r=0;r<e.data.textures.length;r++){var n="iTexture"+r;e.data.renderPasses[t].material.uniforms[n].value=e.data.textures[r]}}}},{key:"updateUniforms",value:function(){this.player.updateUniforms(),this.updateRenderPassUniforms()}},{key:"updateCurMaterial",value:function(e,t){if(0==this.data.editMode)this.player.updateCurMaterial(this.getInputHeader()+e,this.getInputHeader()+t);else for(var r=0;r<this.data.renderPasses.length;r++)this.data.editMode-1==r&&this.data.renderPasses[r].updateMaterial(this.getInputHeader()+t,this.getInputHeader()+e)}},{key:"checkLoadEditorShader",value:function(t,r){var n=null,a=null;n=this.createGLShader(this,e.VERTEX_HEADER_THREE+this.getInputHeader()+r,this.getContext().VERTEX_SHADER),a=this.createGLShader(this,e.FRAG_HEADER_THREE+this.getInputHeader()+t,this.getContext().FRAGMENT_SHADER),a&&n?(this.isValid=!0,this.updateCurMaterial(t,r)):this.isValid=!1;var i=this.getContext();a&&i.deleteShader(a),n&&i.deleteShader(n)}}]),e}();r["default"]=E,t.exports=r["default"]},{"./Player":72,"./RenderPass":73,"./TData":74,"./tools/Loader":76,"./tools/OrbitControls":77,"./tools/TransformControls":78,"./tools/mixin":79,"babel-runtime/helpers/class-call-check":8,"babel-runtime/helpers/create-class":9}],76:[function(e,t,r){"use strict";function n(e,t){var r=this;this.texturePath="",this.loadFile=function(r){var n=r.name,a=n.split(".").pop().toLowerCase(),i=new FileReader;switch(i.addEventListener("progress",function(e){var t="("+Math.floor(e.total/1e3)+" KB)",r=Math.floor(e.loaded/e.total*100)+"%";console.log("Loading",n,t,r)}),a){case"3ds":i.addEventListener("load",function(t){var r=new THREE.TDSLoader,n=r.parse(t.target.result);e&&e(n)},!1),i.readAsArrayBuffer(r);break;case"amf":i.addEventListener("load",function(t){var r=new THREE.AMFLoader,n=r.parse(t.target.result);e&&e(n)},!1),i.readAsArrayBuffer(r);break;case"awd":i.addEventListener("load",function(e){var r=new THREE.AWDLoader,n=r.parse(e.target.result);t&&t(n)},!1),i.readAsArrayBuffer(r);break;case"babylon":i.addEventListener("load",function(e){var r=e.target.result,n=JSON.parse(r),a=new THREE.BabylonLoader,i=a.parse(n);t&&t(i)},!1),i.readAsText(r);break;case"babylonmeshdata":i.addEventListener("load",function(t){var r=t.target.result,a=JSON.parse(r),i=new THREE.BabylonLoader,o=i.parseGeometry(a),s=new THREE.MeshStandardMaterial,c=new THREE.Mesh(o,s);c.name=n,e&&e(c)},!1),i.readAsText(r);break;case"ctm":i.addEventListener("load",function(t){var a=new Uint8Array(t.target.result),i=new CTM.Stream(a);i.offset=0;var o=new THREE.CTMLoader;o.createModel(new CTM.File(i),function(t){t.sourceType="ctm",t.sourceFile=r.name;var a=new THREE.MeshStandardMaterial,i=new THREE.Mesh(t,a);i.name=n,e&&e(i)})},!1),i.readAsArrayBuffer(r);break;case"dae":i.addEventListener("load",function(t){var r=t.target.result,a=new THREE.ColladaLoader,i=a.parse(r);i.scene.name=n,e&&e(i.scene)},!1),i.readAsText(r);break;case"fbx":i.addEventListener("load",function(t){var r=t.target.result,n=new THREE.FBXLoader,a=n.parse(r);e&&e(a)},!1),i.readAsArrayBuffer(r);break;case"glb":case"gltf":i.addEventListener("load",function(t){var r=t.target.result,a=new THREE.GLTFLoader;a.parse(r,"",function(t){t.scene.name=n,e&&e(t.scene)})},!1),i.readAsArrayBuffer(r);break;case"js":case"json":case"3geo":case"3mat":case"3obj":case"3scn":i.addEventListener("load",function(e){var t=e.target.result;if(t.indexOf("postMessage")!==-1){var a=new Blob([t],{type:"text/javascript"}),i=URL.createObjectURL(a),o=new Worker(i);return o.onmessage=function(e){e.data.metadata={version:2},handleJSON(e.data,r,n)},void o.postMessage(Date.now())}var s;try{s=JSON.parse(t)}catch(c){return void alert(c)}handleJSON(s,r,n)},!1),i.readAsText(r);break;case"kmz":i.addEventListener("load",function(t){var r=new THREE.KMZLoader,a=r.parse(t.target.result);a.scene.name=n,e&&e(a.scene)},!1),i.readAsArrayBuffer(r);break;case"md2":i.addEventListener("load",function(t){var r=t.target.result,a=(new THREE.MD2Loader).parse(r),i=new THREE.MeshStandardMaterial({morphTargets:!0,morphNormals:!0}),o=new THREE.Mesh(a,i);o.mixer=new THREE.AnimationMixer(o),o.name=n,e&&e(o)},!1),i.readAsArrayBuffer(r);break;case"obj":i.addEventListener("load",function(t){var r=t.target.result,a=(new THREE.OBJLoader).parse(r);a.name=n,e&&e(a)},!1),i.readAsText(r);break;case"playcanvas":i.addEventListener("load",function(t){var r=t.target.result,n=JSON.parse(r),a=new THREE.PlayCanvasLoader,i=a.parse(n);e&&e(i)},!1),i.readAsText(r);break;case"ply":i.addEventListener("load",function(t){var a=t.target.result,i=(new THREE.PLYLoader).parse(a);i.sourceType="ply",i.sourceFile=r.name;var o=new THREE.MeshStandardMaterial,s=new THREE.Mesh(i,o);s.name=n,e&&e(s)},!1),i.readAsArrayBuffer(r);break;case"stl":i.addEventListener("load",function(t){var a=t.target.result,i=(new THREE.STLLoader).parse(a);i.sourceType="stl",i.sourceFile=r.name;var o=new THREE.MeshStandardMaterial,s=new THREE.Mesh(i,o);s.name=n,e&&e(s)},!1),void 0!==i.readAsBinaryString?i.readAsBinaryString(r):i.readAsArrayBuffer(r);break;case"vtk":i.addEventListener("load",function(t){var a=t.target.result,i=(new THREE.VTKLoader).parse(a);i.sourceType="vtk",i.sourceFile=r.name;var o=new THREE.MeshStandardMaterial,s=new THREE.Mesh(i,o);s.name=n,e&&e(s)},!1),i.readAsText(r);break;case"wrl":i.addEventListener("load",function(e){var r=e.target.result;(new THREE.VRMLLoader).parse(r);t&&t(scene)},!1),i.readAsText(r);break;case"zip":i.addEventListener("load",function(t){var r=t.target.result,n=new JSZip(r);if(n.files["model.obj"]&&n.files["materials.mtl"]){var a=(new THREE.MTLLoader).parse(n.file("materials.mtl").asText()),i=(new THREE.OBJLoader).setMaterials(a).parse(n.file("model.obj").asText());e&&e(i)}},!1),i.readAsBinaryString(r);break;default:alert("Unsupported file format ("+a+").")}},this.handleJSON=function(n,a,i){switch(void 0===n.metadata&&(n.metadata={type:"Geometry"}),void 0===n.metadata.type&&(n.metadata.type="Geometry"),void 0!==n.metadata.formatVersion&&(n.metadata.version=n.metadata.formatVersion),n.metadata.type.toLowerCase()){case"buffergeometry":var o=new THREE.BufferGeometryLoader,s=o.parse(n),c=new THREE.Mesh(s);e&&e(c);break;case"geometry":var o=new THREE.JSONLoader;o.setTexturePath(r.texturePath);var l,s=o.parse(n),u=s.geometry;l=void 0!==s.materials?s.materials.length>1?new THREE.MultiMaterial(s.materials):s.materials[0]:new THREE.MeshStandardMaterial,u.sourceType="ascii",a&&(u.sourceFile=a.name);var c;c=u.animation&&u.animation.hierarchy?new THREE.SkinnedMesh(u,l):new THREE.Mesh(u,l),i&&(c.name=i),e&&e(c);break;case"object":var o=new THREE.ObjectLoader;o.setTexturePath(r.texturePath);var s=o.parse(n);s instanceof THREE.Scene?t&&t(s):e&&e(s);break;case"app":}}}Object.defineProperty(r,"__esModule",{value:!0}),r.Loader=n},{}],77:[function(e,t,r){"use strict";function n(e,t){function r(){return 2*Math.PI/60/60*L.autoRotateSpeed}function n(){return Math.pow(.95,L.zoomSpeed)}function a(e){I.theta-=e}function i(e){I.phi-=e}function o(e){L.object.isPerspectiveCamera?B/=e:L.object.isOrthographicCamera?(L.object.zoom=Math.max(L.minZoom,Math.min(L.maxZoom,L.object.zoom*e)),L.object.updateProjectionMatrix(),G=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),L.enableZoom=!1)}function s(e){L.object.isPerspectiveCamera?B*=e:L.object.isOrthographicCamera?(L.object.zoom=Math.max(L.minZoom,Math.min(L.maxZoom,L.object.zoom/e)),L.object.updateProjectionMatrix(),G=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),L.enableZoom=!1)}function c(e){V.set(e.clientX,e.clientY)}function l(e){q.set(e.clientX,e.clientY)}function u(e){U.set(e.clientX,e.clientY)}function h(e){Y.set(e.clientX,e.clientY),X.subVectors(Y,V);var t=L.domElement===document?L.domElement.body:L.domElement;a(2*Math.PI*X.x/t.clientWidth*L.rotateSpeed),i(2*Math.PI*X.y/t.clientHeight*L.rotateSpeed),V.copy(Y),L.update()}function d(e){Q.set(e.clientX,e.clientY),K.subVectors(Q,q),K.y>0?o(n()):K.y<0&&s(n()),q.copy(Q),L.update()}function f(e){W.set(e.clientX,e.clientY),J.subVectors(W,U),re(J.x,J.y),U.copy(W),L.update()}function p(e){}function m(e){e.deltaY<0?s(n()):e.deltaY>0&&o(n()),L.update()}function v(e){switch(e.keyCode){case L.keys.UP:re(0,L.keyPanSpeed),L.update();break;case L.keys.BOTTOM:re(0,-L.keyPanSpeed),L.update();break;case L.keys.LEFT:re(L.keyPanSpeed,0),L.update();break;case L.keys.RIGHT:re(-L.keyPanSpeed,0),L.update()}}function E(e){V.set(e.touches[0].pageX,e.touches[0].pageY)}function b(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+r*r);q.set(0,n)}function y(e){U.set(e.touches[0].pageX,e.touches[0].pageY)}function g(e){Y.set(e.touches[0].pageX,e.touches[0].pageY),X.subVectors(Y,V);var t=L.domElement===document?L.domElement.body:L.domElement;a(2*Math.PI*X.x/t.clientWidth*L.rotateSpeed),i(2*Math.PI*X.y/t.clientHeight*L.rotateSpeed),V.copy(Y),L.update()}function T(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+r*r);Q.set(0,a),K.subVectors(Q,q),K.y>0?s(n()):K.y<0&&o(n()),q.copy(Q),L.update()}function w(e){W.set(e.touches[0].pageX,e.touches[0].pageY),J.subVectors(W,U),re(J.x,J.y),U.copy(W),L.update()}function x(e){}function R(e){if(L.enabled!==!1){switch(e.preventDefault(),e.button){case L.mouseButtons.ORBIT:if(L.enableRotate===!1)return;c(e),z=F.ROTATE;break;case L.mouseButtons.ZOOM:if(L.enableZoom===!1)return;l(e),z=F.DOLLY;break;case L.mouseButtons.PAN:if(L.enablePan===!1)return;u(e),z=F.PAN}z!==F.NONE&&(document.addEventListener("mousemove",M,!1),document.addEventListener("mouseup",H,!1),L.dispatchEvent(C))}}function M(e){if(L.enabled!==!1)switch(e.preventDefault(),z){case F.ROTATE:if(L.enableRotate===!1)return;h(e);break;case F.DOLLY:if(L.enableZoom===!1)return;d(e);break;case F.PAN:if(L.enablePan===!1)return;f(e)}}function H(e){L.enabled!==!1&&(p(e),document.removeEventListener("mousemove",M,!1),document.removeEventListener("mouseup",H,!1),L.dispatchEvent(_),z=F.NONE)}function j(e){L.enabled===!1||L.enableZoom===!1||z!==F.NONE&&z!==F.ROTATE||(e.preventDefault(),e.stopPropagation(),m(e),L.dispatchEvent(C),L.dispatchEvent(_))}function S(e){L.enabled!==!1&&L.enableKeys!==!1&&L.enablePan!==!1&&v(e)}function P(e){if(L.enabled!==!1){switch(e.touches.length){case 1:if(L.enableRotate===!1)return;E(e),z=F.TOUCH_ROTATE;break;case 2:if(L.enableZoom===!1)return;b(e),z=F.TOUCH_DOLLY;break;case 3:if(L.enablePan===!1)return;y(e),z=F.TOUCH_PAN;break;default:z=F.NONE}z!==F.NONE&&L.dispatchEvent(C)}}function $(e){if(L.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(L.enableRotate===!1)return;if(z!==F.TOUCH_ROTATE)return;g(e);break;case 2:if(L.enableZoom===!1)return;if(z!==F.TOUCH_DOLLY)return;T(e);break;case 3:if(L.enablePan===!1)return;if(z!==F.TOUCH_PAN)return;w(e);break;default:z=F.NONE}}function k(e){L.enabled!==!1&&(x(e),L.dispatchEvent(_),z=F.NONE)}function O(e){L.enabled!==!1&&e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return N.phi},this.getAzimuthalAngle=function(){return N.theta},this.saveState=function(){L.target0.copy(L.target),L.position0.copy(L.object.position),L.zoom0=L.object.zoom},this.toJSON=function(){return{target:L.target,position:L.position,zoom:L.zoom}},this.fromJSON=function(e){L.target0=e.target,L.position0=e.position0,L.zoom0=e.zoom0},this.reset=function(){void 0!=L.target0&&L.target.copy(L.target0),void 0!=L.position0&&L.object.position.copy(L.position0),void 0!=L.object.zoom0&&(L.object.zoom=L.zoom0),L.object.updateProjectionMatrix(),L.dispatchEvent(A),L.update(),z=F.NONE},this.update=function(){var t=new THREE.Vector3,n=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),i=n.clone().inverse(),o=new THREE.Vector3,s=new THREE.Quaternion;return function(){var e=L.object.position;return t.copy(e).sub(L.target),t.applyQuaternion(n),N.setFromVector3(t),L.autoRotate&&z===F.NONE&&a(r()),N.theta+=I.theta,N.phi+=I.phi,N.theta=Math.max(L.minAzimuthAngle,Math.min(L.maxAzimuthAngle,N.theta)),N.phi=Math.max(L.minPolarAngle,Math.min(L.maxPolarAngle,N.phi)),N.makeSafe(),N.radius*=B,N.radius=Math.max(L.minDistance,Math.min(L.maxDistance,N.radius)),L.target.add(Z),t.setFromSpherical(N),t.applyQuaternion(i),e.copy(L.target).add(t),L.object.lookAt(L.target),L.enableDamping===!0?(I.theta*=1-L.dampingFactor,I.phi*=1-L.dampingFactor):I.set(0,0,0),B=1,Z.set(0,0,0),!!(G||o.distanceToSquared(L.object.position)>D||8*(1-s.dot(L.object.quaternion))>D)&&(L.dispatchEvent(A),o.copy(L.object.position),s.copy(L.object.quaternion),G=!1,!0)}}(),this.dispose=function(){L.domElement.removeEventListener("contextmenu",O,!1),L.domElement.removeEventListener("mousedown",R,!1),L.domElement.removeEventListener("wheel",j,!1),L.domElement.removeEventListener("touchstart",P,!1),L.domElement.removeEventListener("touchend",k,!1),L.domElement.removeEventListener("touchmove",$,!1),document.removeEventListener("mousemove",M,!1),document.removeEventListener("mouseup",H,!1),window.removeEventListener("keydown",S,!1)};var L=this,A={type:"change"},C={type:"start"},_={type:"end"},F={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},z=F.NONE,D=1e-6,N=new THREE.Spherical,I=new THREE.Spherical,B=1,Z=new THREE.Vector3,G=!1,V=new THREE.Vector2,Y=new THREE.Vector2,X=new THREE.Vector2,U=new THREE.Vector2,W=new THREE.Vector2,J=new THREE.Vector2,q=new THREE.Vector2,Q=new THREE.Vector2,K=new THREE.Vector2,ee=function(){var e=new THREE.Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),Z.add(e)}}(),te=function(){var e=new THREE.Vector3;return function(t,r){e.setFromMatrixColumn(r,1),e.multiplyScalar(t),Z.add(e)}}(),re=function(){var e=new THREE.Vector3;return function(t,r){var n=L.domElement===document?L.domElement.body:L.domElement;if(L.object.isPerspectiveCamera){var a=L.object.position;e.copy(a).sub(L.target);var i=e.length();i*=Math.tan(L.object.fov/2*Math.PI/180),ee(2*t*i/n.clientHeight,L.object.matrix),te(2*r*i/n.clientHeight,L.object.matrix)}else L.object.isOrthographicCamera?(ee(t*(L.object.right-L.object.left)/L.object.zoom/n.clientWidth,L.object.matrix),te(r*(L.object.top-L.object.bottom)/L.object.zoom/n.clientHeight,L.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),L.enablePan=!1)}}();L.domElement.addEventListener("contextmenu",O,!1),L.domElement.addEventListener("mousedown",R,!1),L.domElement.addEventListener("wheel",j,!1),L.domElement.addEventListener("touchstart",P,!1),L.domElement.addEventListener("touchend",k,!1),L.domElement.addEventListener("touchmove",$,!1),window.addEventListener("keydown",S,!1),this.update()}var a=e("babel-runtime/core-js/object/create")["default"],i=e("babel-runtime/core-js/object/define-properties")["default"];Object.defineProperty(r,"__esModule",{value:!0}),r.OrbitControls=n,n.prototype=a(THREE.EventDispatcher.prototype),n.prototype.constructor=n,i(n.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},{"babel-runtime/core-js/object/create":3,"babel-runtime/core-js/object/define-properties":4}],78:[function(e,t,r){"use strict";function n(e,t){function r(e){if(void 0!==s.object&&d!==!0&&(void 0===e.button||0===e.button)){var t=e.changedTouches?e.changedTouches[0]:e,r=o(t,f[c].pickers.children),n=null;r&&(n=r.object.name,e.preventDefault()),s.axis!==n&&(s.axis=n,s.update(),s.dispatchEvent(v))}}function n(e){if(void 0!==s.object&&d!==!0&&(void 0===e.button||0===e.button)){var t=e.changedTouches?e.changedTouches[0]:e;if(0===t.button||void 0===t.button){var r=o(t,f[c].pickers.children);if(r){e.preventDefault(),e.stopPropagation(),s.dispatchEvent(E),s.axis=r.object.name,s.update(),S.copy(U).sub(V).normalize(),f[c].setActivePlane(s.axis,S);var n=o(t,[f[c].activePlane]);n&&(N.copy(s.object.position),I.copy(s.object.scale),B.extractRotation(s.object.matrix),X.extractRotation(s.object.matrixWorld),Z.extractRotation(s.object.parent.matrixWorld),G.setFromMatrixScale(P.getInverse(s.object.parent.matrixWorld)),x.copy(n.point))}}d=!0}}function a(e){if(void 0!==s.object&&null!==s.axis&&d!==!1&&(void 0===e.button||0===e.button)){var t=e.changedTouches?e.changedTouches[0]:e,r=o(t,[f[c].activePlane]);r!==!1&&(e.preventDefault(),e.stopPropagation(),w.copy(r.point),"translate"===c?(w.sub(x),w.multiply(G),"local"===s.space&&(w.applyMatrix4(P.getInverse(X)),s.axis.search("X")===-1&&(w.x=0),s.axis.search("Y")===-1&&(w.y=0),s.axis.search("Z")===-1&&(w.z=0),w.applyMatrix4(B),s.object.position.copy(N),s.object.position.add(w)),"world"!==s.space&&s.axis.search("XYZ")===-1||(s.axis.search("X")===-1&&(w.x=0),s.axis.search("Y")===-1&&(w.y=0),s.axis.search("Z")===-1&&(w.z=0),w.applyMatrix4(P.getInverse(Z)),s.object.position.copy(N),s.object.position.add(w)),null!==s.translationSnap&&("local"===s.space&&s.object.position.applyMatrix4(P.getInverse(X)),s.axis.search("X")!==-1&&(s.object.position.x=Math.round(s.object.position.x/s.translationSnap)*s.translationSnap),s.axis.search("Y")!==-1&&(s.object.position.y=Math.round(s.object.position.y/s.translationSnap)*s.translationSnap),s.axis.search("Z")!==-1&&(s.object.position.z=Math.round(s.object.position.z/s.translationSnap)*s.translationSnap),"local"===s.space&&s.object.position.applyMatrix4(X))):"scale"===c?(w.sub(x),w.multiply(G),"local"===s.space&&("XYZ"===s.axis?(H=1+w.y/Math.max(I.x,I.y,I.z),s.object.scale.x=I.x*H,s.object.scale.y=I.y*H,s.object.scale.z=I.z*H):(w.applyMatrix4(P.getInverse(X)),"X"===s.axis&&(s.object.scale.x=I.x*(1+w.x/I.x)),"Y"===s.axis&&(s.object.scale.y=I.y*(1+w.y/I.y)),"Z"===s.axis&&(s.object.scale.z=I.z*(1+w.z/I.z))))):"rotate"===c&&(w.sub(V),w.multiply(G),$.copy(x).sub(V),$.multiply(G),"E"===s.axis?(w.applyMatrix4(P.getInverse(j)),$.applyMatrix4(P.getInverse(j)),R.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),M.set(Math.atan2($.z,$.y),Math.atan2($.x,$.z),Math.atan2($.y,$.x)),k.setFromRotationMatrix(P.getInverse(Z)),D.setFromAxisAngle(S,R.z-M.z),C.setFromRotationMatrix(X),k.multiplyQuaternions(k,D),k.multiplyQuaternions(k,C),s.object.quaternion.copy(k)):"XYZE"===s.axis?(D.setFromEuler(w.clone().cross($).normalize()),k.setFromRotationMatrix(P.getInverse(Z)),_.setFromAxisAngle(D,-w.clone().angleTo($)),C.setFromRotationMatrix(X),k.multiplyQuaternions(k,_),k.multiplyQuaternions(k,C),s.object.quaternion.copy(k)):"local"===s.space?(w.applyMatrix4(P.getInverse(X)),$.applyMatrix4(P.getInverse(X)),R.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),M.set(Math.atan2($.z,$.y),Math.atan2($.x,$.z),Math.atan2($.y,$.x)),C.setFromRotationMatrix(B),null!==s.rotationSnap?(_.setFromAxisAngle(O,Math.round((R.x-M.x)/s.rotationSnap)*s.rotationSnap),F.setFromAxisAngle(L,Math.round((R.y-M.y)/s.rotationSnap)*s.rotationSnap),z.setFromAxisAngle(A,Math.round((R.z-M.z)/s.rotationSnap)*s.rotationSnap)):(_.setFromAxisAngle(O,R.x-M.x),F.setFromAxisAngle(L,R.y-M.y),z.setFromAxisAngle(A,R.z-M.z)),"X"===s.axis&&C.multiplyQuaternions(C,_),"Y"===s.axis&&C.multiplyQuaternions(C,F),"Z"===s.axis&&C.multiplyQuaternions(C,z),s.object.quaternion.copy(C)):"world"===s.space&&(R.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),M.set(Math.atan2($.z,$.y),Math.atan2($.x,$.z),Math.atan2($.y,$.x)),k.setFromRotationMatrix(P.getInverse(Z)),null!==s.rotationSnap?(_.setFromAxisAngle(O,Math.round((R.x-M.x)/s.rotationSnap)*s.rotationSnap),F.setFromAxisAngle(L,Math.round((R.y-M.y)/s.rotationSnap)*s.rotationSnap),
z.setFromAxisAngle(A,Math.round((R.z-M.z)/s.rotationSnap)*s.rotationSnap)):(_.setFromAxisAngle(O,R.x-M.x),F.setFromAxisAngle(L,R.y-M.y),z.setFromAxisAngle(A,R.z-M.z)),C.setFromRotationMatrix(X),"X"===s.axis&&k.multiplyQuaternions(k,_),"Y"===s.axis&&k.multiplyQuaternions(k,F),"Z"===s.axis&&k.multiplyQuaternions(k,z),k.multiplyQuaternions(k,C),s.object.quaternion.copy(k))),s.update(),s.dispatchEvent(v),s.dispatchEvent(y))}}function i(e){e.preventDefault(),void 0!==e.button&&0!==e.button||(d&&null!==s.axis&&(b.mode=c,s.dispatchEvent(b)),d=!1,"TouchEvent"in window&&e instanceof TouchEvent?(s.axis=null,s.update(),s.dispatchEvent(v)):r(e))}function o(r,n){var a=t.getBoundingClientRect(),i=(r.clientX-a.left)/a.width,o=(r.clientY-a.top)/a.height;T.set(2*i-1,-(2*o)+1),g.setFromCamera(T,e);var s=g.intersectObjects(n,!0);return!!s[0]&&s[0]}THREE.Object3D.call(this),t=void 0!==t?t:document,this.object=void 0,this.visible=!1,this.translationSnap=null,this.rotationSnap=null,this.space="world",this.size=1,this.axis=null;var s=this,c="translate",d=!1,f={translate:new l,rotate:new u,scale:new h};for(var p in f){var m=f[p];m.visible=p===c,this.add(m)}var v={type:"change"},E={type:"mouseDown"},b={type:"mouseUp",mode:c},y={type:"objectChange"},g=new THREE.Raycaster,T=new THREE.Vector2,w=new THREE.Vector3,x=new THREE.Vector3,R=new THREE.Vector3,M=new THREE.Vector3,H=1,j=new THREE.Matrix4,S=new THREE.Vector3,P=new THREE.Matrix4,$=new THREE.Vector3,k=new THREE.Quaternion,O=new THREE.Vector3(1,0,0),L=new THREE.Vector3(0,1,0),A=new THREE.Vector3(0,0,1),C=new THREE.Quaternion,_=new THREE.Quaternion,F=new THREE.Quaternion,z=new THREE.Quaternion,D=new THREE.Quaternion,N=new THREE.Vector3,I=new THREE.Vector3,B=new THREE.Matrix4,Z=new THREE.Matrix4,G=new THREE.Vector3,V=new THREE.Vector3,Y=new THREE.Euler,X=new THREE.Matrix4,U=new THREE.Vector3,W=new THREE.Euler;t.addEventListener("mousedown",n,!1),t.addEventListener("touchstart",n,!1),t.addEventListener("mousemove",r,!1),t.addEventListener("touchmove",r,!1),t.addEventListener("mousemove",a,!1),t.addEventListener("touchmove",a,!1),t.addEventListener("mouseup",i,!1),t.addEventListener("mouseout",i,!1),t.addEventListener("touchend",i,!1),t.addEventListener("touchcancel",i,!1),t.addEventListener("touchleave",i,!1),this.dispose=function(){t.removeEventListener("mousedown",n),t.removeEventListener("touchstart",n),t.removeEventListener("mousemove",r),t.removeEventListener("touchmove",r),t.removeEventListener("mousemove",a),t.removeEventListener("touchmove",a),t.removeEventListener("mouseup",i),t.removeEventListener("mouseout",i),t.removeEventListener("touchend",i),t.removeEventListener("touchcancel",i),t.removeEventListener("touchleave",i)},this.attach=function(e){this.object=e,this.visible=!0,this.update()},this.detach=function(){this.object=void 0,this.visible=!1,this.axis=null},this.getMode=function(){return c},this.setMode=function(e){c=e?e:c,"scale"===c&&(s.space="local");for(var t in f)f[t].visible=t===c;this.update(),s.dispatchEvent(v)},this.setTranslationSnap=function(e){s.translationSnap=e},this.setRotationSnap=function(e){s.rotationSnap=e},this.setSize=function(e){s.size=e,this.update(),s.dispatchEvent(v)},this.setSpace=function(e){s.space=e,this.update(),s.dispatchEvent(v)},this.update=function(){void 0!==s.object&&(s.object.updateMatrixWorld(),V.setFromMatrixPosition(s.object.matrixWorld),Y.setFromRotationMatrix(P.extractRotation(s.object.matrixWorld)),e.updateMatrixWorld(),U.setFromMatrixPosition(e.matrixWorld),W.setFromRotationMatrix(P.extractRotation(e.matrixWorld)),H=V.distanceTo(U)/6*s.size,this.position.copy(V),this.scale.set(H,H,H),e instanceof THREE.PerspectiveCamera?S.copy(U).sub(V).normalize():e instanceof THREE.OrthographicCamera&&S.copy(U).normalize(),"local"===s.space?f[c].update(Y,S):"world"===s.space&&f[c].update(new THREE.Euler,S),f[c].highlight(s.axis))}}var a=e("babel-runtime/core-js/object/create")["default"];Object.defineProperty(r,"__esModule",{value:!0}),r.TransformControls=n;var i=function(e){THREE.MeshBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.side=THREE.FrontSide,this.transparent=!0,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};i.prototype=a(THREE.MeshBasicMaterial.prototype),i.prototype.constructor=i;var o=function(e){THREE.LineBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.transparent=!0,this.linewidth=1,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(e){e?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};o.prototype=a(THREE.LineBasicMaterial.prototype),o.prototype.constructor=o;var s=new i({visible:!1,transparent:!1}),c=function(){this.init=function(){THREE.Object3D.call(this),this.handles=new THREE.Object3D,this.pickers=new THREE.Object3D,this.planes=new THREE.Object3D,this.add(this.handles),this.add(this.pickers),this.add(this.planes);var e=new THREE.PlaneBufferGeometry(50,50,2,2),t=new THREE.MeshBasicMaterial({visible:!1,side:THREE.DoubleSide}),r={XY:new THREE.Mesh(e,t),YZ:new THREE.Mesh(e,t),XZ:new THREE.Mesh(e,t),XYZE:new THREE.Mesh(e,t)};this.activePlane=r.XYZE,r.YZ.rotation.set(0,Math.PI/2,0),r.XZ.rotation.set(-Math.PI/2,0,0);for(var n in r)r[n].name=n,this.planes.add(r[n]),this.planes[n]=r[n];var a=function(e,t){for(var r in e)for(n=e[r].length;n--;){var a=e[r][n][0],i=e[r][n][1],o=e[r][n][2];a.name=r,i&&a.position.set(i[0],i[1],i[2]),o&&a.rotation.set(o[0],o[1],o[2]),t.add(a)}};a(this.handleGizmos,this.handles),a(this.pickerGizmos,this.pickers),this.traverse(function(e){if(e instanceof THREE.Mesh){e.updateMatrix();var t=e.geometry.clone();t.applyMatrix(e.matrix),e.geometry=t,e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1)}})},this.highlight=function(e){this.traverse(function(t){t.material&&t.material.highlight&&(t.name===e?t.material.highlight(!0):t.material.highlight(!1))})}};c.prototype=a(THREE.Object3D.prototype),c.prototype.constructor=c,c.prototype.update=function(e,t){var r=new THREE.Vector3(0,0,0),n=new THREE.Vector3(0,1,0),a=new THREE.Matrix4;this.traverse(function(i){i.name.search("E")!==-1?i.quaternion.setFromRotationMatrix(a.lookAt(t,r,n)):i.name.search("X")===-1&&i.name.search("Y")===-1&&i.name.search("Z")===-1||i.quaternion.setFromEuler(e)})};var l=function(){c.call(this);var e=new THREE.Geometry,t=new THREE.Mesh(new THREE.CylinderGeometry(0,.05,.2,12,1,(!1)));t.position.y=.5,t.updateMatrix(),e.merge(t.geometry,t.matrix);var r=new THREE.BufferGeometry;r.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,1,0,0],3));var n=new THREE.BufferGeometry;n.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,1,0],3));var a=new THREE.BufferGeometry;a.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new THREE.Mesh(e,new i({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(r,new o({color:16711680}))]],Y:[[new THREE.Mesh(e,new i({color:65280})),[0,.5,0]],[new THREE.Line(n,new o({color:65280}))]],Z:[[new THREE.Mesh(e,new i({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(a,new o({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new i({color:16777215,opacity:.25})),[0,0,0],[0,0,0]]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new i({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new i({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new i({color:16711935,opacity:.25})),[.15,0,.15],[-Math.PI/2,0,0]]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,(!1)),s),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,(!1)),s),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,(!1)),s),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.2,0),s)]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),s),[.2,.2,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),s),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),s),[.2,0,.2],[-Math.PI/2,0,0]]]},this.setActivePlane=function(e,t){var r=new THREE.Matrix4;t.applyMatrix4(r.getInverse(r.extractRotation(this.planes.XY.matrixWorld))),"X"===e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"===e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"===e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===e&&(this.activePlane=this.planes.XYZE),"XY"===e&&(this.activePlane=this.planes.XY),"YZ"===e&&(this.activePlane=this.planes.YZ),"XZ"===e&&(this.activePlane=this.planes.XZ)},this.init()};l.prototype=a(c.prototype),l.prototype.constructor=l;var u=function(){c.call(this);var e=function(e,t,r){var n=new THREE.BufferGeometry,a=[];r=r?r:1;for(var i=0;i<=64*r;++i)"x"===t&&a.push(0,Math.cos(i/32*Math.PI)*e,Math.sin(i/32*Math.PI)*e),"y"===t&&a.push(Math.cos(i/32*Math.PI)*e,0,Math.sin(i/32*Math.PI)*e),"z"===t&&a.push(Math.sin(i/32*Math.PI)*e,Math.cos(i/32*Math.PI)*e,0);return n.addAttribute("position",new THREE.Float32BufferAttribute(a,3)),n};this.handleGizmos={X:[[new THREE.Line(new e(1,"x",.5),new o({color:16711680}))]],Y:[[new THREE.Line(new e(1,"y",.5),new o({color:65280}))]],Z:[[new THREE.Line(new e(1,"z",.5),new o({color:255}))]],E:[[new THREE.Line(new e(1.25,"z",1),new o({color:13421568}))]],XYZE:[[new THREE.Line(new e(1,"z",1),new o({color:7895160}))]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1,.12,4,12,Math.PI),s),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1,.12,4,12,Math.PI),s),[0,0,0],[Math.PI/2,0,0]]],Z:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1,.12,4,12,Math.PI),s),[0,0,0],[0,0,-Math.PI/2]]],E:[[new THREE.Mesh(new THREE.TorusBufferGeometry(1.25,.12,2,24),s)]],XYZE:[[new THREE.Mesh]]},this.setActivePlane=function(e){"E"===e&&(this.activePlane=this.planes.XYZE),"X"===e&&(this.activePlane=this.planes.YZ),"Y"===e&&(this.activePlane=this.planes.XZ),"Z"===e&&(this.activePlane=this.planes.XY)},this.update=function(e,t){c.prototype.update.apply(this,arguments);var r=new THREE.Matrix4,n=new THREE.Euler(0,0,1),a=new THREE.Quaternion,i=new THREE.Vector3(1,0,0),o=new THREE.Vector3(0,1,0),s=new THREE.Vector3(0,0,1),l=new THREE.Quaternion,u=new THREE.Quaternion,h=new THREE.Quaternion,d=t.clone();n.copy(this.planes.XY.rotation),a.setFromEuler(n),r.makeRotationFromQuaternion(a).getInverse(r),d.applyMatrix4(r),this.traverse(function(e){a.setFromEuler(n),"X"===e.name&&(l.setFromAxisAngle(i,Math.atan2(-d.y,d.z)),a.multiplyQuaternions(a,l),e.quaternion.copy(a)),"Y"===e.name&&(u.setFromAxisAngle(o,Math.atan2(d.x,d.z)),a.multiplyQuaternions(a,u),e.quaternion.copy(a)),"Z"===e.name&&(h.setFromAxisAngle(s,Math.atan2(d.y,d.x)),a.multiplyQuaternions(a,h),e.quaternion.copy(a))})},this.init()};u.prototype=a(c.prototype),u.prototype.constructor=u;var h=function(){c.call(this);var e=new THREE.Geometry,t=new THREE.Mesh(new THREE.BoxGeometry(.125,.125,.125));t.position.y=.5,t.updateMatrix(),e.merge(t.geometry,t.matrix);var r=new THREE.BufferGeometry;r.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,1,0,0],3));var n=new THREE.BufferGeometry;n.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,1,0],3));var a=new THREE.BufferGeometry;a.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new THREE.Mesh(e,new i({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(r,new o({color:16711680}))]],Y:[[new THREE.Mesh(e,new i({color:65280})),[0,.5,0]],[new THREE.Line(n,new o({color:65280}))]],Z:[[new THREE.Mesh(e,new i({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(a,new o({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.125,.125,.125),new i({color:16777215,opacity:.25}))]]},this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,(!1)),s),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,(!1)),s),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderBufferGeometry(.2,0,1,4,1,(!1)),s),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.BoxBufferGeometry(.4,.4,.4),s)]]},this.setActivePlane=function(e,t){var r=new THREE.Matrix4;t.applyMatrix4(r.getInverse(r.extractRotation(this.planes.XY.matrixWorld))),"X"===e&&(this.activePlane=this.planes.XY,Math.abs(t.y)>Math.abs(t.z)&&(this.activePlane=this.planes.XZ)),"Y"===e&&(this.activePlane=this.planes.XY,Math.abs(t.x)>Math.abs(t.z)&&(this.activePlane=this.planes.YZ)),"Z"===e&&(this.activePlane=this.planes.XZ,Math.abs(t.x)>Math.abs(t.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===e&&(this.activePlane=this.planes.XYZE)},this.init()};h.prototype=a(c.prototype),h.prototype.constructor=h,n.prototype=a(THREE.Object3D.prototype),n.prototype.constructor=n},{"babel-runtime/core-js/object/create":3}],79:[function(e,t,r){"use strict";function n(e){var t=new a;return i(e,{on:function(e,r){var n={};n[e]=r,t.add(n)},off:function(e,r){if(r){var n={};n[e]=r,t["delete"](n)}else{var a=!0,i=!1,c=void 0;try{for(var l,u=o(t);!(a=(l=u.next()).done);a=!0){var h=l.value,d=!0,f=!1,p=void 0;try{for(var m,v=o(s(h));!(d=(m=v.next()).done);d=!0){var E=m.value;if(E===e)return void t["delete"](h)}}catch(b){f=!0,p=b}finally{try{!d&&v["return"]&&v["return"]()}finally{if(f)throw p}}}}catch(b){i=!0,c=b}finally{try{!a&&u["return"]&&u["return"]()}finally{if(i)throw c}}}},offAll:function(){t.clear()},trigger:function(e){var r=!0,n=!1,a=void 0;try{for(var i=arguments.length,s=Array(i>1?i-1:0),c=1;c<i;c++)s[c-1]=arguments[c];for(var l,u=o(t);!(r=(l=u.next()).done);r=!0){var h=l.value;"function"==typeof h[e]&&h[e].apply(h,s)}}catch(d){n=!0,a=d}finally{try{!r&&u["return"]&&u["return"]()}finally{if(n)throw a}}},listSubscriptions:function(){var e=!0,r=!1,n=void 0;try{for(var a,i=o(t);!(e=(a=i.next()).done);e=!0){var s=a.value;console.log(s)}}catch(c){r=!0,n=c}finally{try{!e&&i["return"]&&i["return"]()}finally{if(r)throw n}}}})}var a=e("babel-runtime/core-js/set")["default"],i=e("babel-runtime/core-js/object/assign")["default"],o=e("babel-runtime/core-js/get-iterator")["default"],s=e("babel-runtime/core-js/object/keys")["default"];Object.defineProperty(r,"__esModule",{value:!0}),r.subscribeMixin=n},{"babel-runtime/core-js/get-iterator":1,"babel-runtime/core-js/object/assign":2,"babel-runtime/core-js/object/keys":6,"babel-runtime/core-js/set":7}]},{},[75])(75)});